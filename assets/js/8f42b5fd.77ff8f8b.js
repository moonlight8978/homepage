(self.webpackChunkmoonlight_8978_github_io=self.webpackChunkmoonlight_8978_github_io||[]).push([[2280],{3905:function(n,t,e){"use strict";e.d(t,{Zo:function(){return u},kt:function(){return s}});var a=e(7294);function r(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function i(n,t){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),e.push.apply(e,a)}return e}function l(n){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?i(Object(e),!0).forEach((function(t){r(n,t,e[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))}))}return n}function o(n,t){if(null==n)return{};var e,a,r=function(n,t){if(null==n)return{};var e,a,r={},i=Object.keys(n);for(a=0;a<i.length;a++)e=i[a],t.indexOf(e)>=0||(r[e]=n[e]);return r}(n,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(a=0;a<i.length;a++)e=i[a],t.indexOf(e)>=0||Object.prototype.propertyIsEnumerable.call(n,e)&&(r[e]=n[e])}return r}var c=a.createContext({}),p=function(n){var t=a.useContext(c),e=t;return n&&(e="function"==typeof n?n(t):l(l({},t),n)),e},u=function(n){var t=p(n.components);return a.createElement(c.Provider,{value:t},n.children)},m={inlineCode:"code",wrapper:function(n){var t=n.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(n,t){var e=n.components,r=n.mdxType,i=n.originalType,c=n.parentName,u=o(n,["components","mdxType","originalType","parentName"]),h=p(e),s=r,g=h["".concat(c,".").concat(s)]||h[s]||m[s]||i;return e?a.createElement(g,l(l({ref:t},u),{},{components:e})):a.createElement(g,l({ref:t},u))}));function s(n,t){var e=arguments,r=t&&t.mdxType;if("string"==typeof n||r){var i=e.length,l=new Array(i);l[0]=h;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=n,o.mdxType="string"==typeof n?n:r,l[1]=o;for(var p=2;p<i;p++)l[p]=e[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,e)}h.displayName="MDXCreateElement"},5892:function(n,t,e){"use strict";e.r(t),e.d(t,{frontMatter:function(){return o},metadata:function(){return c},toc:function(){return p},default:function(){return m}});var a=e(2122),r=e(9756),i=(e(7294),e(3905)),l=["components"],o={slug:"cung-tim-hieu-ve-railway-oriented-programming",title:"C\xf9ng t\xecm hi\u1ec3u v\u1ec1 Railway Oriented Programming",author:"L\xea S\u0129 B\xedch",author_title:"Ruby on Rails/React Developer",author_url:"https://github.com/moonlight8978",author_image_url:"https://avatars.githubusercontent.com/u/26299310?v=4",tags:["ruby","javascript","functional-programing","railway-oriented-programming"]},c={permalink:"/blog/cung-tim-hieu-ve-railway-oriented-programming",editUrl:"https://github.com/moonlight8978/moonlight8978.github.io/edit/v2/blog/blog/2019-03-16-railway-oriented-programming.md",source:"@site/blog/2019-03-16-railway-oriented-programming.md",title:"C\xf9ng t\xecm hi\u1ec3u v\u1ec1 Railway Oriented Programming",description:"Khi m\u1edbi b\u1eaft \u0111\u1ea7u code, c\xf3 th\u1ec3 ch\xfang ta r\u1ea5t ng\u1ea1i handle nh\u1eefng exception m\xe0 ngay c\u1ea3 1 h\xe0m \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u0169ng c\xf3 th\u1ec3 tung ra. Tuy nhi\xean, th\u1ef1c t\u1ebf khi x\xe2y d\u1ef1ng h\u1ec7 th\u1ed1ng, ta ph\u1ea3i \u0111\u1eb7c bi\u1ec7t ch\xfa \xfd \u0111\u1ebfn nh\u1eefng exception, kh\xf4ng th\xec \u1ee9ng d\u1ee5ng c\u1ee7a ta c\xf3 th\u1ec3 th\u0103ng b\u1ea5t c\u1ee9 l\xfac n\xe0o :v",date:"2019-03-16T00:00:00.000Z",formattedDate:"March 16, 2019",tags:[{label:"ruby",permalink:"/blog/tags/ruby"},{label:"javascript",permalink:"/blog/tags/javascript"},{label:"functional-programing",permalink:"/blog/tags/functional-programing"},{label:"railway-oriented-programming",permalink:"/blog/tags/railway-oriented-programming"}],readingTime:7.095,truncated:!1,prevItem:{title:"C\xf9ng t\xecm hi\u1ec3u v\u1ec1 ActionText trong Rails 6",permalink:"/blog/cung-tim-hieu-ve-actiontext-trong-rails-6"},nextItem:{title:"M\u1ed9t v\xe0i mindset khi l\xe0m vi\u1ec7c v\u1edbi React",permalink:"/blog/mot-vai-mindset-khi-lam-viec-voi-react"}},p=[],u={toc:p};function m(n){var t=n.components,e=(0,r.Z)(n,l);return(0,i.kt)("wrapper",(0,a.Z)({},u,e,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Khi m\u1edbi b\u1eaft \u0111\u1ea7u code, c\xf3 th\u1ec3 ch\xfang ta r\u1ea5t ng\u1ea1i handle nh\u1eefng exception m\xe0 ngay c\u1ea3 1 h\xe0m \u0111\u01a1n gi\u1ea3n nh\u1ea5t c\u0169ng c\xf3 th\u1ec3 tung ra. Tuy nhi\xean, th\u1ef1c t\u1ebf khi x\xe2y d\u1ef1ng h\u1ec7 th\u1ed1ng, ta ph\u1ea3i \u0111\u1eb7c bi\u1ec7t ch\xfa \xfd \u0111\u1ebfn nh\u1eefng exception, kh\xf4ng th\xec \u1ee9ng d\u1ee5ng c\u1ee7a ta c\xf3 th\u1ec3 th\u0103ng b\u1ea5t c\u1ee9 l\xfac n\xe0o :v"),(0,i.kt)("p",null,"V\u1eady th\xec l\xe0m sao \u0111\u1ec3 handle ch\xfang 1 c\xe1ch th\u1eadt ",(0,i.kt)("em",{parentName:"p"},"clean"),". C\xf3 kh\xe1 nhi\u1ec1u h\u01b0\u1edbng ti\u1ebfp c\u1eadn, tuy nhi\xean ta h\xe3y c\xf9ng th\u1eed tr\u1ea3i nghi\u1ec7m theo h\u01b0\u1edbng ",(0,i.kt)("em",{parentName:"p"},"Railway Oriented")," xem n\xf3 c\xf3 g\xec hay."),(0,i.kt)("p",null,"B\xe0i gi\u1edbi thi\u1ec7u g\u1ed1c \u0111\u01b0\u1ee3c vi\u1ebft s\u1eed d\u1ee5ng ng\xf4n ng\u1eef F#, nh\u01b0ng ta ho\xe0n to\xe0n c\xf3 th\u1ec3 \xe1p d\u1ee5ng v\xe0o c\xe1c ng\xf4n ng\u1eef kh\xe1c nh\u01b0 Javascript, Ruby, ..."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Railway Oriented Programming")," ph\xf9 h\u1ee3p v\u1edbi style l\u1eadp tr\xecnh h\xe0m (Functional Programming - FP)"),(0,i.kt)("p",null,"T\xean g\u1ecdi l\xe0 ",(0,i.kt)("em",{parentName:"p"},"Railway")," c\u0169ng b\u1edfi tr\xf4ng n\xf3 kh\xe1 gi\u1ed1ng v\u1edbi \u0111\u01b0\u1eddng ray t\xe0u h\u1ecfa."),(0,i.kt)("h1",{id:"v\u1ea5n-\u0111\u1ec1"},"V\u1ea5n \u0111\u1ec1"),(0,i.kt)("p",null,"H\xe3y b\u1eaft \u0111\u1ea7u v\u1edbi 1 usecase r\u1ea5t c\u01a1 b\u1ea3n"),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"Ng\u01b0\u1eddi d\xf9ng mu\u1ed1n c\u1eadp nh\u1eadt profile c\u1ee7a h\u1ecd.")),(0,i.kt)("p",null,"Sau khi ng\u01b0\u1eddi d\xf9ng submit th\xf4ng tin \u1edf web, ta hay c\xf9ng ph\xe2n t\xedch nh\u1eefng x\u1eed l\xfd \u1edf ph\xeda server"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/e37fd6b1-91fc-4340-8938-154196463a70.jpg",alt:null})),(0,i.kt)("p",null,"T\xecnh hu\u1ed1ng \u0111\u1eb9p nh\u1ea5t x\u1ea3y ra l\xe0 t\u1eeb b\u01b0\u1edbc 1-5, \u1ee9ng d\u1ee5ng ta s\u1ebd ch\u1ea1y tr\u01a1n tru, kh\xf4ng c\xf3 b\u1ea5t c\u1ee9 1 l\u1ed7i n\xe0o."),(0,i.kt)("p",null,"Nh\u01b0ng m\xe0 ..."),(0,i.kt)("blockquote",null,(0,i.kt)("p",{parentName:"blockquote"},"\u0110\u1eddi kh\xf4ng nh\u01b0 m\u01a1, t\xecnh kh\xf4ng nh\u01b0 th\u01a1.")),(0,i.kt)("p",null,"T\u1eeb b\u01b0\u1edbc 1-4 \u0111\u1ec1u c\xf3 th\u1ec3 c\xf3 l\u1ed7i x\u1ea3y ra, v\xe0 t\u1ea5t nhi\xean ng\u01b0\u1eddi d\xf9ng s\u1ebd kh\xf4ng h\u1ec1 mu\u1ed1n nh\xecn th\u1ea5y c\u1ea3nh n\xe0y"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/e05c2f5c-ee9e-4f78-958d-bd54ff7b291c.jpg",alt:null})),(0,i.kt)("p",null,"V\u1eady th\xec nh\u1eefng g\xec ta c\u1ea7n l\xe0m l\xe0 x\u1eed l\xfd nh\u1eefng l\u1ed7i n\xe0y, kh\xf4ng th\xec ng\u01b0\u1eddi d\xf9ng m\u1ed9t \u0111i kh\xf4ng tr\u1edf l\u1ea1i lu\xf4n."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/d7ea1ee4-2326-408a-be91-e361803f7f0b.jpeg",alt:null})),(0,i.kt)("p",null,"V\xe0 ta s\u1ebd vi\u1ebft code cho n\xf3:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-javascript"},'function updateUser(user) {\n  const request = receiveRequest();\n  if (!isValidRequest(request)) {\n    return "Request is forbidden";\n  }\n  if (!isValidUser(request)) {\n    return "User information is invalid";\n  }\n  try {\n    saveToDatabase(request);\n  } catch (error) {\n    return "DB error";\n  }\n  try {\n    sendEmail(request);\n  } catch (error) {\n    return "Mailer error";\n  }\n  return "OK";\n}\n')),(0,i.kt)("p",null,"Code tr\xean \u0111\u01b0\u1ee3c vi\u1ebft theo style Imperative, v\xec th\u1ebf n\xean ta c\xf3 th\u1ec3 return b\u1ea5t c\u1ee9 l\xfac n\xe0o ta mu\u1ed1n. \u0110i\u1ec1u \u0111\xf3 l\xe0m h\xe0m c\u1ee7a ta c\xf3 th\u1ec3 return theo r\u1ea5t nhi\u1ec1u c\xe1ch (nhi\u1ec1u ki\u1ec3u response kh\xe1c nhau)."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/13ab6aca-df34-41a5-89fe-85e6b8de4523.png",alt:null})),(0,i.kt)("p",null,"Ta s\u1ebd design l\u1ea1i flow theo style FP."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/e20339fb-142c-46a8-8d29-965f6ebcf63f.png",alt:null})),(0,i.kt)("p",null,"H\xe0m c\u1ee7a ta gi\u1edd \u0111\xe2y:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Ch\u1ec9 c\xf3 2 ki\u1ec3u tr\u1ea3 v\u1ec1: ",(0,i.kt)("inlineCode",{parentName:"p"},"Success")," ho\u1eb7c ",(0,i.kt)("inlineCode",{parentName:"p"},"Failure"),"."),(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Success:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// @flow\ntype Success = { data: object };\n"))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Failure:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// @flow\ntype Failure = { error: string };\n"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Use case \u0111\u01b0\u1ee3c x\xe2y d\u1ef1ng t\u1eeb 1 series c\xe1c h\xe0m con t\u01b0\u01a1ng \u1ee9ng v\u1edbi m\u1ed7i step."))),(0,i.kt)("p",null,"Ta s\u1ebd \xe1p d\u1ee5ng ",(0,i.kt)("em",{parentName:"p"},"Railway Oriented Programming")," \u0111\u1ec3 gi\u1ea3i quy\u1ebft v\u1ea5n \u0111\u1ec1 n\xe0y."),(0,i.kt)("h1",{id:"railway-oriented-programming"},"Railway Oriented Programming"),(0,i.kt)("h4",{id:"monad"},"Monad"),(0,i.kt)("p",null,"Trong l\u1eadp tr\xecnh h\xe0m, c\xf3 m\u1ed9t c\xe1ch \u0111\u1ec3 handle l\u1ed7i l\xe0 d\xf9ng ",(0,i.kt)("em",{parentName:"p"},"monad"),"."),(0,i.kt)("p",null,"Monad th\u01b0\u1eddng \u0111i k\xe8m v\u1edbi Applicative v\xe0 Functor n\u1eefa, b\u1ecdn n\xe0y kh\xe1 l\xe0 xo\u1eafn n\xe3o n\xean m\xecnh s\u1ebd kh\xf4ng \u0111\u1ec1 c\u1eadp \u1edf \u0111\xe2y."),(0,i.kt)("p",null,"Ta s\u1ebd ch\u1ec9 quan t\xe2m t\u1edbi: ",(0,i.kt)("em",{parentName:"p"},"Either")," monad."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// @flow\ntype Either<A, B> = A | B;\ntype FunctionReturnMonad<A, B> = () => Either<A, B>;\n")),(0,i.kt)("p",null,"Hi\u1ec3u m\u1ed9t c\xe1ch n\xf4m na s\u1ebd l\xe0: h\xe0m c\u1ee7a ta s\u1ebd lu\xf4n tr\u1ea3 v\u1ec1 A ho\u1eb7c B, nh\u01b0ng kh\xf4ng bao gi\u1edd tr\u1ea3 v\u1ec1 c\u1ea3 2."),(0,i.kt)("h4",{id:"switch"},"Switch"),(0,i.kt)("p",null,"H\xe3y b\u1eaft \u0111\u1ea7u v\u1edbi 1 function c\xf3 th\u1ec3 g\xe2y ra l\u1ed7i:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'function validateNameNotBlank(user) {\n  if (user.name === "") {\n    return { error: "Name is blank" };\n  }\n  return { data: user };\n}\n')),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/4214182b-82ca-4ff1-9f86-7161b063632d.jpg",alt:null})),(0,i.kt)("p",null,"\u0110\xe2y ch\xednh l\xe0 1 switch, n\xf3 r\u1ebd nh\xe1nh lu\u1ed3ng x\u1eed l\xfd c\u1ee7a ta th\xe0nh ",(0,i.kt)("inlineCode",{parentName:"p"},"Success")," v\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"Failure"),"."),(0,i.kt)("h4",{id:"k\u1ebft-n\u1ed1i-nhi\u1ec1u-switch"},"K\u1ebft n\u1ed1i nhi\u1ec1u switch"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/b6cf8618-c07c-4502-86a3-90b1b6ab3530.png",alt:null})),(0,i.kt)("p",null,"\u0110\xe2y l\xe0 ",(0,i.kt)("em",{parentName:"p"},"\u0111\u01b0\u1eddng ray")," ho\xe0n ch\u1ec9nh m\xe0 ta c\u1ea7n x\xe2y d\u1ef1ng t\u1eeb nh\u1eefng switch ri\xeang l\u1ebb tr\xean."),(0,i.kt)("p",null,"C\xf3 th\u1ec3 nh\u1eadn th\u1ea5y m\u1ed9t v\xe0i \u0111i\u1ec3m quan tr\u1ecdng \u1edf railway n\xe0y:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Khi m\u1ed9t step b\u1ecb l\u1ed7i, n\xf3 s\u1ebd kh\xf4ng return function ngay l\u1eadp t\u1ee9c, m\xe0 s\u1ebd ti\u1ebfp t\u1ee5c ch\u1ea1y v\xe0o c\xe1c function ti\u1ebfp theo cho t\u1edbi khi k\u1ebft th\xfac flow."),(0,i.kt)("p",{parentName:"li"},"Tuy nhi\xean k\u1ebft qu\u1ea3 cu\u1ed1i c\xf9ng nh\u1eadn \u0111\u01b0\u1ee3c ch\u1ec9 l\xe0 l\u1ed7i \u0111\u1ea7u ti\xean ph\xe1t sinh.")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},"Nh\u1eefng h\xe0m c\u1ee7a t\u1eebng step \u0111\u1ec1u ph\u1ea3i x\u1eed l\xfd c\u1ea3 tr\u01b0\u1eddng h\u1ee3p c\xf3 d\u1eef li\u1ec7u v\xe0 tr\u01b0\u1eddng h\u1ee3p h\xe0m tr\u01b0\u1edbc tr\u1ea3 v\u1ec1 l\u1ed7i"))),(0,i.kt)("p",null,"B\xe2y gi\u1edd v\u1ea5n \u0111\u1ec1 l\xe0 l\xe0m th\u1ebf n\xe0o \u0111\u1ec3 n\u1ed1i nh\u1eefng switch l\u1ea1i v\u1edbi nhau?"),(0,i.kt)("p",null,"C\xe2u tr\u1ea3 l\u1eddi l\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"compose"),". Tuy nhi\xean ta kh\xf4ng th\u1ec3 compose theo c\xe1ch th\xf4ng th\u01b0\u1eddng \u0111\u01b0\u1ee3c."),(0,i.kt)("p",null,"V\xed d\u1ee5 nh\u01b0:"),(0,i.kt)("p",null,"N\u1ebfu \u0111\u1ea7u v\xe0o v\xe0 \u0111\u1ea7u ra c\u1ee7a ta c\xf9ng interface"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const mul2 = (num) => num * 2;\nconst add1 = (num) => num + 1;\nmul2(add1(1)); // 4\n")),(0,i.kt)("p",null,"Tr\u1edf l\u1ea1i h\xe0m ",(0,i.kt)("inlineCode",{parentName:"p"},"validateBlank")," \u1edf tr\xean, n\u1ebfu ta c\xf3 nhi\u1ec1u h\xe0m ",(0,i.kt)("inlineCode",{parentName:"p"},"validate")," kh\xe1c t\u01b0\u01a1ng t\u1ef1"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/02d95ea0-c572-481b-bb2b-d2801667e9a0.png",alt:null})),(0,i.kt)("p",null,"Ta c\xf3 th\u1ec3 th\u1ea5y \u0111\u1ea7u v\xe0o ch\u1ec9 c\xf3 1, m\xe0 l\u1ea1i c\xf3 nh\u1eefng 2 \u0111\u1ea7u ra."),(0,i.kt)("p",null,"\u0110\u1ec3 c\xf3 th\u1ec3 compose, ta s\u1ebd ph\u1ea3i bi\u1ebfn ch\xfang th\xe0nh nh\u1eefng function c\xf3 th\u1ec3 handle c\u1ea3 tr\u01b0\u1eddng h\u1ee3p ",(0,i.kt)("inlineCode",{parentName:"p"},"Success")," l\u1eabn ",(0,i.kt)("inlineCode",{parentName:"p"},"Failure"),"."),(0,i.kt)("p",null,"C\xf3 th\u1ec3 s\u1eed d\u1ee5ng HOC"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const transformToTwoTrackInput =\n  (func) =>\n  ({ data, error }) => {\n    return data ? func(data) : { error };\n  };\n\nconst twoTrackValidateNameNotBlank =\n  transformToTwoTrackInput(validateNameNotBlank);\nconst twoTrackValidateName50 = transformToTwoTrackInput(validateName50);\nconst twoTrackValidateEmailNotBlank = transformToTwoTrackInput(\n  validateEmailNotBlank\n);\n\nconst user = { email: "", name: "" };\ntwoTrackValidateEmailNotBlank(\n  twoTrackValidateName50(twoTrackValidateNameNotBlank({ data: user }))\n); // { error: \'name is blank\' }\n')),(0,i.kt)("p",null,"Nh\u01b0 v\u1eady l\xe0 ta \u0111\xe3 k\u1ebft n\u1ed1i \u0111\u01b0\u1ee3c nh\u1eefng m\u1ea3nh gh\xe9p tr\xean v\u1edbi nhau."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/59045ab0-2465-4163-8c25-1b7529749196.png",alt:null})),(0,i.kt)("h4",{id:"m\u1ed9t-v\xe0i-ki\u1ec3u-function-th\u01b0\u1eddng-g\u1eb7p"},"M\u1ed9t v\xe0i ki\u1ec3u function th\u01b0\u1eddng g\u1eb7p"),(0,i.kt)("h5",{id:"single-track-function"},"Single track function"),(0,i.kt)("p",null,"N\u1ebfu m\u1ed9t function kh\xf4ng g\xe2y ra l\u1ed7i (ch\u1ec9 c\xf3 1 \u0111\u1ea7u v\xe0o v\xe0 1 \u0111\u1ea7u ra) th\xec n\xf3 s\u1ebd kh\xf4ng th\u1ec3 n\xe0o compose \u0111\u01b0\u1ee3c v\xe0o railway c\u1ee7a ch\xfang ta."),(0,i.kt)("p",null,"Khi \u0111\xf3 ta ph\u1ea3i wrap n\xf3 b\u1edfi 2-track function, gi\u1ed1ng v\u1edbi HOC \u1edf tr\xean."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/754c4226-95b0-4b98-81dc-e64ed7842ee9.jpg",alt:null})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const trimEmail(user) {\n  return {\n    ...user,\n    email: user.email.trim()\n  }\n}\n\nconst transformSingleTrackToTwoTrackInput = func => ({ data, error }) => {\n  return data ? func(data) : { error }\n}\n\nconst user = { email: '  sample@email.com' }\ntransformSingleTrackToTwoTrackInput(trimEmail)({ data: user })\n")),(0,i.kt)("h5",{id:"dead-end-function"},"Dead-end function"),(0,i.kt)("p",null,"Dead-end function l\xe0 nh\u1eefng h\xe0m void, kh\xf4ng c\xf3 gi\xe1 tr\u1ecb tr\u1ea3 v\u1ec1"),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/55f5aa49-c5c8-498f-a175-edd967b3d5c2.jpg",alt:null})),(0,i.kt)("p",null,"M\xe0u t\xedm ch\xednh l\xe0 n\u01a1i ta s\u1ebd \u0111\u1eb7t ",(0,i.kt)("em",{parentName:"p"},"dead-end function")," v\xe0o"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const transformDeadEndFunction =\n  (func) =>\n  ({ data, error }) => {\n    if (data) {\n      func();\n      return { data };\n    } else {\n      return { error };\n    }\n  };\n")),(0,i.kt)("h5",{id:"function-throw-exception"},"Function throw Exception"),(0,i.kt)("p",null,"Ta c\xf3 th\u1ec3 \u0111\u1eb7t try-catch \u0111\u1ec3 tr\u1ea3 v\u1ec1 Failure"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const transformExceptionFunction =\n  (func) =>\n  ({ data, error }) => {\n    if (data) {\n      try {\n        func();\n      } catch (error) {\n        return { error: error.message || error };\n      }\n      return { data };\n    } else {\n      return { error };\n    }\n  };\n")),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Note"),": Convert t\u1ea5t c\u1ea3 Exception th\xe0nh ",(0,i.kt)("inlineCode",{parentName:"p"},"Failure")),(0,i.kt)("h4",{id:"k\u1ebft-qu\u1ea3"},"K\u1ebft qu\u1ea3"),(0,i.kt)("p",null,"Ta kh\xf4ng th\u1ec3 tr\u1ea3 v\u1ec1 d\u1eef li\u1ec7u ki\u1ec3u two-track cho client \u0111\u01b0\u1ee3c, v\xec v\u1eady ta s\u1ebd c\xf3 th\xeam 1 b\u01b0\u1edbc cu\u1ed1i \u0111\u1ec3 tr\u1ea3 v\u1ec1 th\xf4ng tin cho client."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/08650333-ae3a-4fa8-b960-09c7b11fbd79.jpg",alt:null})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"function returnMessage({ data, error }) {\n  return data ? JSON.stringify(data) : error.toString();\n}\n")),(0,i.kt)("h1",{id:"rop-trong-m\u1ed9t-s\u1ed1-ng\xf4n-ng\u1eef-kh\xe1c"},"ROP trong m\u1ed9t s\u1ed1 ng\xf4n ng\u1eef kh\xe1c"),(0,i.kt)("h4",{id:"ruby-framework-rails"},"Ruby (framework Rails)"),(0,i.kt)("p",null,"N\u1ebfu c\xe1c b\u1ea1n s\u1eed d\u1ee5ng Rails, h\xe3y th\u1eed tr\u1ea3i nghi\u1ec7m qua gem ",(0,i.kt)("inlineCode",{parentName:"p"},"trailblazer"),". Logic c\u1ee7a \u1ee9ng d\u1ee5ng gi\u1edd s\u1ebd t\u1eadp trung ch\u1ee7 y\u1ebfu trong c\xe1c ",(0,i.kt)("inlineCode",{parentName:"p"},"Operation")," thay v\xec controller nh\u01b0 x\u01b0a n\u1eefa, m\xe0 nh\u1eefng operation n\xe0y \u0111\u01b0\u1ee3c vi\u1ebft theo style ROP."),(0,i.kt)("p",null,(0,i.kt)("img",{parentName:"p",src:"https://images.viblo.asia/f425b9c2-0d14-460b-8540-f289e8859972.gif",alt:null})),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ruby"},'class Song::Create < Trailblazer::Operation\n  step    Model(Song, :new) # init model\n  step    :assign_current_user!\n  step    Contract::Build(constant: SongForm) # create form object\n  step    Contract::Validate() # validate form object\n  failure :log_error!\n  step    Contract::Persist() # save song to db\n\n  def log_error!(options)\n    logger.debug "Errors occurred while creating song."\n  end\n\n  def assign_current_user!(options)\n    options["model"].created_by = options["current_user"]\n  end\nend\n')),(0,i.kt)("p",null,"Flow c\u1ee7a Operation kh\xf4ng ho\xe0n to\xe0n gi\u1ed1ng v\u1edbi ROP nh\u01b0 ta \u0111\xe3 th\u1ea5y \u1edf tr\xean, m\u1ed9t khi b\u1ea1n \u0111\xe3 v\xe0o nh\xe1nh Failure, n\xf3 s\u1ebd trigger to\xe0n b\u1ed9 nh\u1eefng step handle error ph\xeda sau."),(0,i.kt)("p",null,"Kh\xf4ng li\xean quan l\u1eafm nh\u01b0ng trong ",(0,i.kt)("inlineCode",{parentName:"p"},"trailblazer")," ecosystem c\xf3 kh\xe1 nhi\u1ec1u gem th\xfa v\u1ecb nh\u01b0: ",(0,i.kt)("inlineCode",{parentName:"p"},"reform")," (form object pattern), v\xe0 ",(0,i.kt)("inlineCode",{parentName:"p"},"cells")," (view components)."),(0,i.kt)("h4",{id:"javascript"},"Javascript"),(0,i.kt)("p",null,"N\u1ebfu ta \u0111\u1ec3 \xfd, ",(0,i.kt)("inlineCode",{parentName:"p"},"Promise")," c\u1ee7a Javascript c\u0169ng kh\xe1 gi\u1ed1ng v\u1edbi ROP."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},'const user = { username: "sample", email: "sample" };\n\nconst validatePresenceOfUsername = (data) => {\n  if (!!data.username) {\n    return user;\n  }\n  throw "Username is blank";\n};\n\nconst validateFormatOfEmail = (data) => {\n  if (data.email && data.email.match(/@/g)) {\n    return user;\n  }\n  throw "Email is in invalid format";\n};\n\nconst logError = (error) => console.error(error);\n\nPromise.resolve(user)\n  .then(validatePresenceOfUsername)\n  .then(validateFormatOfEmail)\n  .catch(logError); // => \'Email is in invalid format\n')),(0,i.kt)("h1",{id:"tham-kh\u1ea3o"},"Tham kh\u1ea3o"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://fsharpforfunandprofit.com/rop/"},"https://fsharpforfunandprofit.com/rop/")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://fsharpforfunandprofit.com/posts/function-composition/"},"https://fsharpforfunandprofit.com/posts/function-composition/")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://dorp.io/posts/railway-oriented-programming/"},"https://dorp.io/posts/railway-oriented-programming/")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/trailblazer/trailblazer"},"https://github.com/trailblazer/trailblazer")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"http://trailblazer.to/gems/operation/2.0/api.html"},"http://trailblazer.to/gems/operation/2.0/api.html")))}m.isMDXComponent=!0}}]);