<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Tối ưu mệnh đề WHERE (MySQL) | Welcome to my personal blog | _MoonLight_</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://moonlight8978.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://moonlight8978.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://moonlight8978.github.io/blog/toi-uu-menh-de-where-mysql"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Tối ưu mệnh đề WHERE (MySQL) | Welcome to my personal blog | _MoonLight_"><meta data-rh="true" name="description" content="Có 2 hướng tối ưu Database chính:"><meta data-rh="true" property="og:description" content="Có 2 hướng tối ưu Database chính:"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2019-11-14T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/moonlight8978"><meta data-rh="true" property="article:tag" content="mysql,database,optimization"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://moonlight8978.github.io/blog/toi-uu-menh-de-where-mysql"><link data-rh="true" rel="alternate" href="https://moonlight8978.github.io/blog/toi-uu-menh-de-where-mysql" hreflang="en"><link data-rh="true" rel="alternate" href="https://moonlight8978.github.io/blog/toi-uu-menh-de-where-mysql" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Welcome to my personal blog | _MoonLight_ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Welcome to my personal blog | _MoonLight_ Atom Feed">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.9709e2f3.css">
<script src="/assets/js/runtime~main.9d85f8d2.js" defer="defer"></script>
<script src="/assets/js/main.2e5390a1.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_pAeB" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/peach-goma-pc-night-keyboard-smashing-sd.gif" alt="Goma smashing his keyboard" class="themedComponent_RIc6 themedComponent--light_aQWN"><img src="/peach-goma-pc-night-keyboard-smashing-sd.gif" alt="Goma smashing his keyboard" class="themedComponent_RIc6 themedComponent--dark_XAeT"></div><b class="navbar__title text--truncate">Home</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_sT5S"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_c7W3 colorModeToggle_k_Ia"><button class="clean-btn toggleButton_vdzZ toggleButtonDisabled_T9bY" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Vd5J"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_Yt2c"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_cTIM"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_jMRO"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_WlgU thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_knSc margin-bottom--md">Recent posts</div><ul class="sidebarItemList_OaoK clean-list"><li class="sidebarItem_gihs"><a class="sidebarItemLink_dDE_" href="/blog/tim-hieu-ve-active-record-encryption">Tìm hiểu về Active Record Encryption</a></li><li class="sidebarItem_gihs"><a class="sidebarItemLink_dDE_" href="/blog/websocket-hoat-dong-nhu-the-nao">WebSocket hoạt động như thế nào?</a></li><li class="sidebarItem_gihs"><a class="sidebarItemLink_dDE_" href="/blog/cung-tim-hieu-ve-puma-ruby-on-rails">Cùng tìm hiểu về Puma (Ruby on Rails)</a></li><li class="sidebarItem_gihs"><a class="sidebarItemLink_dDE_" href="/blog/cuoi-react-native-xem-appium-phan-1-cung-tim-hieu-cach-hoat-dong-cua-appium">Cưỡi React Native xem Appium (Phần 1 - Cùng tìm hiểu cách hoạt động của Appium)</a></li><li class="sidebarItem_gihs"><a class="sidebarItemLink_dDE_" href="/blog/gioi-thieu-ve-kubernetes">Giới thiệu về Kubernetes</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="https://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="https://schema.org/BlogPosting"><meta itemprop="description" content="Có 2 hướng tối ưu Database chính:"><header><h1 class="title_DEF8" itemprop="headline">Tối ưu mệnh đề WHERE (MySQL)</h1><div class="container_Y0Yj margin-vert--md"><time datetime="2019-11-14T00:00:00.000Z" itemprop="datePublished">November 14, 2019</time> · <!-- -->9 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_fNYc"><div class="avatar margin-bottom--sm"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="Lê Sĩ Bích" itemprop="image"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/moonlight8978" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Lê Sĩ Bích</span></a></div><small class="avatar__subtitle" itemprop="description">Ruby on Rails/React Developer</small></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><p>Có 2 hướng tối ưu Database chính:</p>
<h3 class="anchor anchorWithStickyNavbar_FlIw" id="1-tối-ưu-tầng-db">1. Tối ưu tầng DB<a href="#1-tối-ưu-tầng-db" class="hash-link" aria-label="Direct link to 1. Tối ưu tầng DB" title="Direct link to 1. Tối ưu tầng DB">​</a></h3>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="cấu-trúc-db">Cấu trúc DB:<a href="#cấu-trúc-db" class="hash-link" aria-label="Direct link to Cấu trúc DB:" title="Direct link to Cấu trúc DB:">​</a></h5>
<ul>
<li>Đọc nhiều =&gt; ít table, nhiều column</li>
<li>Ghi nhiều =&gt; nhiều table, ít column</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="index-đã-ổn-chưa">Index đã ổn chưa?<a href="#index-đã-ổn-chưa" class="hash-link" aria-label="Direct link to Index đã ổn chưa?" title="Direct link to Index  đã ổn chưa?">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="engine-cho-table">Engine cho table<a href="#engine-cho-table" class="hash-link" aria-label="Direct link to Engine cho table" title="Direct link to Engine cho table">​</a></h5>
<ul>
<li>MyISAM: Table-locking, phù hợp với table đọc nhiều, ghi ít</li>
<li>InnoDB: Row-locking, đáp ứng được việc ghi nhiều.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="caching">Caching<a href="#caching" class="hash-link" aria-label="Direct link to Caching" title="Direct link to Caching">​</a></h5>
<h3 class="anchor anchorWithStickyNavbar_FlIw" id="2-tối-ưu-phần-cứng">2. Tối ưu phần cứng<a href="#2-tối-ưu-phần-cứng" class="hash-link" aria-label="Direct link to 2. Tối ưu phần cứng" title="Direct link to 2. Tối ưu phần cứng">​</a></h3>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="disk-seek">Disk seek:<a href="#disk-seek" class="hash-link" aria-label="Direct link to Disk seek:" title="Direct link to Disk seek:">​</a></h5>
<ul>
<li>Thời gian HDD quay khi tìm dữ liệu, SDD không cần quay để tìm dữ liệu.</li>
<li>Phân tán dữ liệu để tìm trên nhiều ổ đĩa cùng lúc.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="disk-rw">Disk R/W:<a href="#disk-rw" class="hash-link" aria-label="Direct link to Disk R/W:" title="Direct link to Disk R/W:">​</a></h5>
<ul>
<li>Khi tìm được dữ liệu thì sẽ cần đọc dữ liệu vào RAM.</li>
<li>Phân tán để đọc/ghi nhiều trên nhiều ổ đĩa cùng lúc.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="cpu-cycle">CPU cycle<a href="#cpu-cycle" class="hash-link" aria-label="Direct link to CPU cycle" title="Direct link to CPU cycle">​</a></h5>
<ul>
<li>Khi đã load được vào RAM rồi, thì sẽ tới CPU xử lý những dữ liệu đó.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="memory-bandwidth">Memory bandwidth:<a href="#memory-bandwidth" class="hash-link" aria-label="Direct link to Memory bandwidth:" title="Direct link to Memory bandwidth:">​</a></h5>
<ul>
<li>Khi CPU cần nhiều dữ liệu, nhưng cache lại không đủ, sẽ cần đến memory bandwith.</li>
</ul>
<h1>2. Tối ưu câu lệnh WHERE</h1>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="ngoài-select-thì-còn-áp-dụng-được-cho-cả-update-delete-vv">Ngoài SELECT thì còn áp dụng được cho cả UPDATE, DELETE, v.v.<a href="#ngoài-select-thì-còn-áp-dụng-được-cho-cả-update-delete-vv" class="hash-link" aria-label="Direct link to Ngoài SELECT thì còn áp dụng được cho cả UPDATE, DELETE, v.v." title="Direct link to Ngoài SELECT thì còn áp dụng được cho cả UPDATE, DELETE, v.v.">​</a></h5>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="mysql-sẽ-tự-động-tối-ưu-những-trường-hợp-sau">MySQL sẽ tự động tối ưu những trường hợp sau:<a href="#mysql-sẽ-tự-động-tối-ưu-những-trường-hợp-sau" class="hash-link" aria-label="Direct link to MySQL sẽ tự động tối ưu những trường hợp sau:" title="Direct link to MySQL sẽ tự động tối ưu những trường hợp sau:">​</a></h5>
<ul>
<li>
<p>Loại bỏ những dấu ngoặc thừa</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> d</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Thay thế biến bởi hằng số</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">a</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">b </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">c</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> a</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> b</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> a</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Loại bỏ những điều kiện hằng</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> b</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">7</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> b</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> b</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">6</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Biểu thức hằng (constant expression) sẽ chỉ được tính toán 1 lần duy nhất.</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> POW</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> t</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> id </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> FLOOR</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> RAND</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><code>HAVING</code> sẽ được gộp với <code>WHERE</code> khi không sử dụng <code>GROUP BY</code> hay những function như <code>COUNT()</code>, <code>MIN()</code>, <code>MAX()</code>, ...</p>
</li>
<li>
<p>Đối với <strong>MyISAM</strong> hay <strong>MEMORY</strong> table, kết quả của <code>COUNT(*)</code> (không có điều kiện <code>WHERE</code> sẽ được lấy trực tiếp từ <strong>information_schema</strong>.</p>
</li>
</ul>
<p>=&gt; Ta có thể ngừng việc tối ưu lại, và viết những câu lệnh SQL dễ hiểu, dễ bảo trì.</p>
<h1>3. Range optimization</h1>
<ul>
<li><code>range</code> là một <strong>access method</strong></li>
<li><code>range</code> sử dụng index để lấy ra những subset của kết quả cuối cùng.</li>
<li><code>range</code> support cả single-part lẫn multiple-part index.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_FlIw" id="những-trường-hợp-sau-mysql-sẽ-coi-như-là-range-condition">Những trường hợp sau, MySQL sẽ coi như là <code>range condition</code>:<a href="#những-trường-hợp-sau-mysql-sẽ-coi-như-là-range-condition" class="hash-link" aria-label="Direct link to những-trường-hợp-sau-mysql-sẽ-coi-như-là-range-condition" title="Direct link to những-trường-hợp-sau-mysql-sẽ-coi-như-là-range-condition">​</a></h4>
<ul>
<li>
<p>Mệnh đề <code>WHERE</code> đối với những trường được  đánh index (sử dụng BTree hoặc Hash), mà sử dụng những toán tử sau: <code>=</code>, <code>&lt;=&gt;</code>, <code>IN()</code>, <code>IS NULL</code>, hay <code>IS NOT NULL</code></p>
<p>Đối với, BTree, ngoài những phép toán trên, còn support thêm <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>BETWEEN</code>, <code>!=</code>, hay <code>&lt;&gt;</code> với <strong>constant value</strong>, hoặc <code>LIKE</code> cũng là range condition. Chú ý khi sử dụng <code>LIKE</code>, vế phải phải là 1 string hằng, và không bắt đầu bởi wildcard như <code>%</code> hay <code>_</code>.</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> key_col </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ab%&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p>Kết hợp nhiều range condition sử dụng <code>AND</code> hoặc <code>OR</code>, ta vẫn thu được range condition.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_FlIw" id="constant-value">Constant value<a href="#constant-value" class="hash-link" aria-label="Direct link to Constant value" title="Direct link to Constant value">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="là-giá-trị-được-tính-toán-trước-thời-điểm-runtime-khi-runtime-giá-trị-của-nó-sẽ-không-thay-đổi">Là giá trị được tính toán trước thời điểm runtime, khi runtime, giá trị của nó sẽ không thay đổi<a href="#là-giá-trị-được-tính-toán-trước-thời-điểm-runtime-khi-runtime-giá-trị-của-nó-sẽ-không-thay-đổi" class="hash-link" aria-label="Direct link to Là giá trị được tính toán trước thời điểm runtime, khi runtime, giá trị của nó sẽ không thay đổi" title="Direct link to Là giá trị được tính toán trước thời điểm runtime, khi runtime, giá trị của nó sẽ không thay đổi">​</a></h5>
<ul>
<li>Hằng số truyền thẳng vào tham số của câu truy vấn</li>
<li>Một cột của <code>const</code> hay <code>system</code> table<!-- -->
<ul>
<li><code>const</code> table là bảng chỉ có tối đa 1 row (hay 0 hoặc 1 row).</li>
<li><code>const</code> table có thể là kết quả của 1 câu truy vấn chứa mệnh đề <code>WHERE</code> đối với 1 field unique, not null, có dạng <code>column = constant</code>. Truy vấn này luôn trả về 1 kết quả duy nhất.</li>
<li>table có 1 row thì gọi là <code>system</code> table</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_FlIw" id="btree-hash-index">BTree, Hash index<a href="#btree-hash-index" class="hash-link" aria-label="Direct link to BTree, Hash index" title="Direct link to BTree, Hash index">​</a></h4>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="btree">BTree:<a href="#btree" class="hash-link" aria-label="Direct link to BTree:" title="Direct link to BTree:">​</a></h5>
<ul>
<li>
<p>Self-balancing tree, cấu trúc dạng cây, có thể tự cân bằng nhằm giữ chiều cao của cây thấp nhất có thể.</p>
</li>
<li>
<p>Tránh nhầm với Binary Tree (cây nhị phân)</p>
</li>
<li>
<p>Thời gian tìm kiếm O(logn)</p>
</li>
<li>
<p>Phù hợp với đa dạng các phép toán: <code>=</code>, <code>&lt;=&gt;</code>, <code>IN()</code>, <code>IS NULL</code>, <code>IS NOT NULL</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>BETWEEN</code>, <code>!=</code>, <code>&lt;&gt;</code>, hay thậm chí cả <code>LIKE</code></p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://camo.githubusercontent.com/cb15fccfa6fafa1cea762a58c1dd51ad8f32fe2c/68747470733a2f2f63646e2d696d616765732d312e6d656469756d2e636f6d2f6d61782f313630302f312a70453453457a374370727a4664375a77772d617866512e6a706567" alt="" class="img_XBWr"></p>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="hash">Hash:<a href="#hash" class="hash-link" aria-label="Direct link to Hash:" title="Direct link to Hash:">​</a></h5>
<ul>
<li>
<p>Bảng băm, là cấu trúc dữ liệu lưu theo key-value</p>
</li>
<li>
<p>Tìm kiếm theo key rất nhanh - O(1)</p>
</li>
<li>
<p>Phù hợp với những phép toán: <code>=</code>, <code>&lt;=&gt;</code>, <code>IN()</code>, <code>IS NULL</code>, hay <code>IS NOT NULL</code>.</p>
</li>
</ul>
<p><img decoding="async" loading="lazy" src="https://camo.githubusercontent.com/b1df2be12b1c8779b7cf941d88d1cc8e2178753f/68747470733a2f2f696d616765732e7669626c6f2e617369612f30356236313638372d386230342d346536352d613834642d3361353363343035386437642e6a7067" alt="" class="img_XBWr"></p>
<h2 class="anchor anchorWithStickyNavbar_FlIw" id="31-single-part-index">3.1. Single-part index<a href="#31-single-part-index" class="hash-link" aria-label="Direct link to 3.1. Single-part index" title="Direct link to 3.1. Single-part index">​</a></h2>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="single-part-index-là-những-index-được-đánh-riêng-lẻ-cho-1-field">Single-part index là những index được đánh riêng lẻ cho 1 field.<a href="#single-part-index-là-những-index-được-đánh-riêng-lẻ-cho-1-field" class="hash-link" aria-label="Direct link to Single-part index là những index được đánh riêng lẻ cho 1 field." title="Direct link to Single-part index là những index được đánh riêng lẻ cho 1 field.">​</a></h5>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> index_name </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> t1 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_col</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Khi thực hiện truy vấn với những index loại này, với mỗi possible key (có thể sử dụng <code>EXPLAIN</code> để check), MySQL sẽ tiến hành extract range condition. Những điều kiện không thể cấu thành range condition sẽ bị loại bỏ, những điều kiện có thể bị overlap sẽ được gộp với nhau.</p>
<p>Sau khi extract, MySQL sẽ áp dụng những điều kiện đó để tận dụng được tối đa index của table, sau đó kết hợp thêm với những điều kiện còn lại để lọc tiếp.</p>
<p>MySQL chỉ bỏ qua index, nếu như nó tin rằng việc duyệt full table tối ưu hơn, hoặc dùng <code>FORCE INDEX</code>.</p>
<p>VD:</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">FROM</span><span class="token plain"> t1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">WHERE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abcde%&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> key1 </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%b&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> nonkey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;uux&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key1 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;z&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">LIKE</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abcde%&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;uux&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key1 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;z&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bar&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">TRUE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">FALSE</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;abc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bar&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> key1 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;bar&#x27;</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_FlIw" id="32-multiple-part-index">3.2. Multiple-part index<a href="#32-multiple-part-index" class="hash-link" aria-label="Direct link to 3.2. Multiple-part index" title="Direct link to 3.2. Multiple-part index">​</a></h2>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="multiple-part-index-là-những-index-được-đánh-cho-nhiều-trường-cùng-lúc">Multiple-Part Index là những index được đánh cho nhiều trường cùng lúc<a href="#multiple-part-index-là-những-index-được-đánh-cho-nhiều-trường-cùng-lúc" class="hash-link" aria-label="Direct link to Multiple-Part Index là những index được đánh cho nhiều trường cùng lúc" title="Direct link to Multiple-Part Index là những index được đánh cho nhiều trường cùng lúc">​</a></h5>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">INDEX</span><span class="token plain"> index_name </span><span class="token keyword" style="color:#00009f">ON</span><span class="token plain"> t1 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> key_part2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Range condition sẽ sử dụng <strong>key tuple intervals</strong> để tìm kiếm. Key tuple intervals được định nghĩa bởi những key tuples, có thứ tự.</p>
<p><strong>Tuple</strong> là 1 cặp giá trị. VD: (1, 2, 3), (1, &#x27;a&#x27;, 3), ...</p>
<p>Lấy ví dụ về 1 multiple-part index <code>key1(key_part1, key_part2, key_part3)</code>, và những tuples ứng với key tuple (key_part1, key_part2, key_part3) sau:</p>
<div class="language-plaintext codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-plaintext codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token plain">key_part1  key_part2  key_part3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NULL       1          &#x27;abc&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NULL       1          &#x27;xyz&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NULL       2          &#x27;foo&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1         1          &#x27;abc&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1         1          &#x27;xyz&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   1         2          &#x27;abc&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   2         1          &#x27;aaa&#x27;</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>key_part1 = 1</code> define interval sau:</p>
<div class="language-plaintext codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-plaintext codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token plain">(1,-inf,-inf) &lt;= (key_part1,key_part2,key_part3) &lt; (1,+inf,+inf)</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Interval trên sẽ được sử dụng bởi <code>range</code> access method.</p>
<p>Bên cạnh đó, <code>key_part3 = &#x27;abc&#x27;</code> không tạo ra interval nào (giá trị liền mạch nhau), vì thế sẽ không thể sử dụng bởi <code>range</code></p>
<p>Chú ý khi sử dụng:</p>
<ul>
<li>
<p>Với Hash index, nếu index có <code>N</code> part, thì condition của ta phải có format sau</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token plain">    key_part1 cmp const1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key_part2 cmp const2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key_partN cmp constN</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>cmp</code> là một trong những toán tử <code>=</code>, <code>&lt;=&gt;</code>, hoặc <code>IS NULL</code></p>
</li>
<li>
<p>Với BTree index, 1 interval có thể sử dụng cho những điều kiện kết hợp bởi <code>AND</code>, trong đó mỗi điều kiện so sánh 1 key part với 1 hằng số, sử dụng <code>=</code>, <code>&lt;=&gt;</code>, <code>IS NULL</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>&lt;&gt;</code>.</p>
<p>Optimizer trong khi tính toán interval, sẽ sử dụng thêm key part nếu toán tử là <code>=</code>, <code>&lt;=&gt;</code> hay <code>IS NULL</code>. Còn nếu là <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>, <code>&lt;&gt;</code>, <code>BETWEEN</code> hay <code>LIKE</code> thì sẽ không lấy thêm key part nữa.</p>
<p>VD1:</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token plain">key_part1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key_part2 </span><span class="token operator" style="color:#393A34">&gt;=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key_part3 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>sẽ sử dụng interval:</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key_part2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key_part3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">inf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">inf</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>VD2:</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_part1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">AND</span><span class="token plain"> key_part2 </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_part1 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>sẽ sử dụng 2 interval:</p>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key_part2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">inf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key_part1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">key_part2</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Trong ví dụ này, interval thứ nhất sử dụng 1 key part ở vế trái, vế phải sử dụng 2 key part.</p>
<p>Interval thứ 2 chỉ sử dụng 1 key part.</p>
<p>Giá trị <code>key_len</code> khi thực hiện <code>EXPLAIN</code> sẽ trả về độ dài tối đa của key prefix được sử dụng.</p>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_FlIw" id="index-dive">Index Dive<a href="#index-dive" class="hash-link" aria-label="Direct link to Index Dive" title="Direct link to Index Dive">​</a></h3>
<p>Index dive được thực hiện trong khi optimizing để tính toán estimate (số row thỏa mãn 1 condition), để quyết định xem có nên dùng index hay không. Có thể skip bằng cách dùng <code>FORCE INDEX</code></p>
<p>Nếu điều kiện phức tạp thì index dive sẽ mất nhiều thời gian.</p>
<p>Ngoài index dive, MySQL cũng có thể sử dụng index statistics để estimate, tuy nhiên độ chính xác thấp hơn, có thể dùng <code>ANALYZE TABLE</code> để update lại index statistics, tăng cường độ chính xác.</p>
<p>Index dive bị skip trong trường hợp thỏa mãn tất cả điều kiện sau (chỉ áp dụng cho single table query):</p>
<ul>
<li><code>FORCE INDEX</code></li>
<li>Nonunique index, và không phải <code>FULLTEXT</code> index.</li>
<li>Không có subquery</li>
<li>Không có <code>DISTINCT</code>, <code>GROUP BY</code>, hoặc <code>ORDER BY</code>.</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_FlIw" id="equality-range-optimization-of-many-valued-comparisons">Equality Range Optimization of Many-Valued Comparisons<a href="#equality-range-optimization-of-many-valued-comparisons" class="hash-link" aria-label="Direct link to Equality Range Optimization of Many-Valued Comparisons" title="Direct link to Equality Range Optimization of Many-Valued Comparisons">​</a></h5>
<div class="language-sql codeBlockContainer_TxQF theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_If66"><pre tabindex="0" class="prism-code language-sql codeBlock_vqFy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_jmgN"><span class="token-line" style="color:#393A34"><span class="token plain">col_name </span><span class="token operator" style="color:#393A34">IN</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">val1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> valN</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">col_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> val1 </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">OR</span><span class="token plain"> col_name </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> valN</span><br></span></code></pre><div class="buttonGroup_DYdX"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_PLQI" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_k4AK"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_OnZW"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Những biểu thức như trên, với <code>col_name</code> được đánh index, và so sánh với nhiều giá trị, được gọi là range comparisions (mỗi range là 1 giá trị). Optimizer sẽ estimate cost của mỗi range như sau:</p>
<ul>
<li>Nếu index là unique, cost = 1</li>
<li>Nếu không unique, sẽ cần sử dụng index dive hoặc index statistics để estimate.</li>
</ul>
<p>Ứng với mỗi range là 2 lần dive (1 cho điểm bắt đầu, 1 cho điểm kết thúc) của range (interval).</p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_hIgz"><div class="col"><b>Tags:</b><ul class="tags_qmVs padding--none margin-left--sm"><li class="tag_aHj4"><a class="tag_rlZX tagRegular_E7nr" href="/blog/tags/mysql">mysql</a></li><li class="tag_aHj4"><a class="tag_rlZX tagRegular_E7nr" href="/blog/tags/database">database</a></li><li class="tag_aHj4"><a class="tag_rlZX tagRegular_E7nr" href="/blog/tags/optimization">optimization</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2019-11-14-optimize-mysql-where-statement.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_v73a" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/gioi-thieu-ve-kubernetes"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Giới thiệu về Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/cung-tim-hieu-ve-actiontext-trong-rails-6"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Cùng tìm hiểu về ActionText trong Rails 6</div></a></nav></main><div class="col col--2"><div class="tableOfContents_jZrJ thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-tối-ưu-tầng-db" class="table-of-contents__link toc-highlight">1. Tối ưu tầng DB</a></li><li><a href="#2-tối-ưu-phần-cứng" class="table-of-contents__link toc-highlight">2. Tối ưu phần cứng</a></li><li><a href="#31-single-part-index" class="table-of-contents__link toc-highlight">3.1. Single-part index</a></li><li><a href="#32-multiple-part-index" class="table-of-contents__link toc-highlight">3.2. Multiple-part index</a><ul><li><a href="#index-dive" class="table-of-contents__link toc-highlight">Index Dive</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_sT5S"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_sT5S"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_sT5S"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_sT5S"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>