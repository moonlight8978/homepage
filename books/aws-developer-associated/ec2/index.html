<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.0">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="moonlight8978's Blog Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="moonlight8978's Blog Blog Atom Feed"><title data-react-helmet="true">AWS Elastic Compute Cloud (EC2) | moonlight8978&#x27;s Blog</title><meta data-react-helmet="true" property="og:url" content="https://moonlight8978.github.io/books/aws-developer-associated/ec2"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-books-current"><meta data-react-helmet="true" property="og:title" content="AWS Elastic Compute Cloud (EC2) | moonlight8978&#x27;s Blog"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="https://avatars.githubusercontent.com/u/26299310?v=4"><link data-react-helmet="true" rel="canonical" href="https://moonlight8978.github.io/books/aws-developer-associated/ec2"><link data-react-helmet="true" rel="alternate" href="https://moonlight8978.github.io/books/aws-developer-associated/ec2" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://moonlight8978.github.io/books/aws-developer-associated/ec2" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.5f3c8191.css">
<link rel="preload" href="/assets/js/runtime~main.9bf10215.js" as="script">
<link rel="preload" href="/assets/js/main.a4c2403e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">_MoonLight_</strong></a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/docs/intro">Programming notes</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/books/intro">Book notes</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle displayOnlyInLargeViewport_GrZ2 react-toggle--disabled" role="button" tabindex="-1"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="https://avatars.githubusercontent.com/u/26299310?v=4" alt="moonlight8978" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">_MoonLight_</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/docs/intro">Programming notes</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/books/intro">Book notes</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/books/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">AWS Certified Developer - Associated</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/intro">Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/api-gateway">AWS API Gateway</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/auto-scaling-group">Auto Scaling Group</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/ci-cd">CI/CD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/cloud-formation">AWS CloudFormation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/cloud-front">AWS CloudFront</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/cloud-trail">AWS Cloud Trail</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/code-star">AWS CodeStar</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/cognito">AWS Cognito</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/dynamo-db">DynamoDB</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/books/aws-developer-associated/ec2">AWS Elastic Compute Cloud (EC2)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/ecs">Elastic Container Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/elasti-cache">AWS Elasti Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/elastic-beanstalk">Elastic Beanstalk notes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/elb">Elastic Load Balancer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/event-bridge">AWS EventBridge</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/iam">IAM</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/kinesis">AWS Kinesis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/kms">AWS KMS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/lambda">Lambda</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/parameter-store">AWS SSM Parameter Store</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/rds">RDS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/route53">AWS Route 53</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/s3">AWS Simple Storage Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/sam">AWS Serverless Application Model</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/secrets-manager">AWS Secrets Manager</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/security-group">AWS Security Group</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/ses">AWS Simple Email Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/sns">AWS Simple Notification Service</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/sqs">Amazon SQS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/step-functions">AWS Step Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/vpc">AWS Virtual Private Cloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/books/aws-developer-associated/x-ray">AWS X-Ray</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Database</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/books/database/high-performance-mysql">High Performance MySQL</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Javascript</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/books/javascript/ecma">ECMA</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">MySQL Docs - Optimization (Chapter 8)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/books/mysql-chap8/where">Tá»‘i Æ°u SELECT</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/books/mysql-chap8/subquery">Optimize Subquery vá»›i Semijoin transformation</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">World Wide Web</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/books/www/oauth2-in-action">OAuth2 in Action</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">AWS Elastic Compute Cloud (EC2)</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><ul><li>Elastic Compute Cloud â†’ ECC â†’ EC2</li><li>Things can be configured:<ul><li>CPU, RAM (All instances use ECC RAM), Network (Public IP, Network speed)</li><li>Storage (SSD)</li><li>Firewall (Security Group)</li><li>Bootstrap script (User Data):<ul><li>Run at the instance first start. Once run, it never run again.</li><li>Run with the root user</li></ul></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="instance-types"></a>Instance types<a class="hash-link" href="#instance-types" title="Direct link to heading">#</a></h2><ul><li><p>Mac: Mac machine to build/test/develop iOS app</p></li><li><p>T4g:</p><ul><li>Busrtable general purpose</li><li>Arm-based AWS Graviton2 CPU (Custom built AWS Graviton2 Processor with 64-bit Arm Neoverse cores)</li></ul></li><li><p>Unlimited mode by default</p><ul><li>EBS-optimized by default</li><li>Network bandwidth: Up to 5Gbps</li></ul></li><li><p>T3:</p><ul><li>Burstable general purpose</li><li>2.5 GHz Intel Xeon Scalable Processor</li><li>Unlimited mode by default</li><li>EBS optimized</li><li>Network bandwidth: Up to 5Gbps</li><li>AWS Nito System, Xeon =&gt; 30% price performance improvement over T2 instances</li></ul></li><li><p>T3a:</p><ul><li>Burstable general purpose</li><li>AMD EPYC 7000 series processors with an all core turbo clock speed of 2.5 GHz</li><li>Unlimited mode by default</li><li>AWS Nitro System</li><li>EBS optimized</li><li>Network: Up to 5Gbps</li><li>Deliver up to 10% cost savings over comparable instance types</li></ul></li><li><p>T2:</p><ul><li>Burstable performance</li><li>High frequency Intel Xeon processors (3.0 ~ 3.3GHz)</li><li>Standard mode by default</li><li>Network (Low - Moderate performance)</li></ul></li><li><p>M6g:</p><ul><li>Arm-based AWS Graviton2 processors</li><li>EBS-optimized by default</li><li>deliver up to 40% better price/performance over current generation M5 instances and offer a balance of compute, memory, and networking resources</li><li>AWS Nitro System</li><li>EBS or NVMe SSDs</li><li>Network: 10~15Gbps</li></ul></li><li><p>M5:</p><ul><li>Latest generation of General Purpose Instances</li><li>Network: 10-25Gbps</li><li>Up to 3.1 GHz Intel XeonÂ® Platinum 8175M processors with new Intel Advanced Vector Extension (AVX-512) instruction set</li><li>EBS or NVMe SSDs</li><li>AWS Nitro System</li></ul></li><li><p>M5a:</p><ul><li>General Purpose</li><li>AMD EPYC 7000 series processors with an all core turbo clock speed of 2.5 GHz</li><li>Network: 10-20Gbps</li><li>EBS or NVMe SSDs</li><li>AWS Nitro System</li></ul></li><li><p>M5n:</p><ul><li>2nd generation Intel Xeon Scalable Processors (Cascade Lake) with a sustained all-core Turbo CPU frequency of 3.1 GHz and maximum single core turbo frequency of 3.5 GHz</li><li>Support for the new Intel Vector Neural Network Instructions (AVX-512 VNNI) (for Machine Learning)</li><li>Network: 25-100Gbps</li><li>EBS or NVMe SSDs</li><li>AWS Nitro System</li></ul></li><li><p>M5zn:</p><ul><li>2nd Generation Intel Xeon Scalable Processors (Cascade Lake) with an all-core turbo frequency up to 4.5 GHz</li><li>Network 25-100Gbps</li><li>High single thread performance</li></ul></li><li><p>M4:</p><ul><li>2.3 GHz Intel XeonÂ® E5-2686 v4 (Broadwell) processors or 2.4 GHz Intel XeonÂ® E5-2676 v3 (Haswell) processors</li><li>EBS-optimized by default</li><li>Network: Moderate - 25Gbps</li></ul></li><li><p>A1:</p><ul><li>Custom built AWS Graviton Processor with 64-bit Arm Neoverse cores</li><li>Network: Up to 10Gbps</li><li>EBS-optimized by default</li><li>AWS Nitro System</li></ul></li><li><p>Compute optimized: C instances</p><ul><li>Usecase: scientific modeling, dedicated game servers, and server engines</li></ul></li><li><p>Memory optimized: R, X instances</p><ul><li>Usecase: real-time big data analytics, in-memory cache, in-memory databases</li></ul></li><li><p>Accelerated computing: P4, P3, P2, Inf1, G4dn, G4ad, G3, F1</p><ul><li>Usecase: machine learning, speech recognization, compute finance, ...</li></ul></li><li><p>Storage optimized: I, D, H instances</p><ul><li>Usecase: NoSQL, in-memory or transaction databases, data warehouse, ...</li></ul></li><li><p>Burstable</p><ul><li>Burstable:<ul><li>Traditional Amazon EC2 instance types provide fixed CPU utilization, while burstable performance instances provide a baseline level of CPU utilization with the ability to burst CPU utilization above the baseline level.</li><li>The baseline utilization and ability to burst are governed by CPU credits.</li><li>If a burstable performance instance uses fewer CPU resources than is required for baseline utilization (such as when it is idle), the unspent CPU credits are accrued in the CPU credit balance. If a burstable performance instance needs to burst above the baseline utilization level, it spends the accrued credits. The more credits that a burstable performance instance has accrued, the more time it can burst beyond its baseline when more CPU utilization is needed.</li></ul></li><li>CPU credits: The following scenarios all use one CPU credit<ul><li>One vCPU at 100% utilization for one minute</li><li>One vCPU at 50% utilization for two minutes</li><li>Two vCPUs at 25% utilization for two minutes</li></ul></li><li>EBS-optimized:</li><li>Unlimited mode:<ul><li>A burstable performance instance configured as <code>unlimited</code> can sustain high CPU utilization for any period of time whenever required.</li><li>Charges might apply if your average utilization over a rolling 24-hour period exceeds the baseline utilization of the instance.</li></ul></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="instance-profile"></a>Instance Profile<a class="hash-link" href="#instance-profile" title="Direct link to heading">#</a></h2><ul><li>Recommend over embeded credentials</li><li>IAM Policy ---&gt; IAM Role ---&gt; Instance profile &lt;--- EC2 Instance</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="placement-groups"></a>Placement groups<a class="hash-link" href="#placement-groups" title="Direct link to heading">#</a></h2><ul><li>Are logical placement</li><li>Cluster:<ul><li>Pack instances together inside a AZ</li><li>Low-latency for tightly coupled note-to-node communication</li><li>Cannot be multi AZ</li><li>Well suited for HPC applications</li></ul></li><li>Partition:<ul><li>Spread across logical partitions (inside a AZ ?)</li><li>Each partition does not share the same hardware with each other (rack per partition)</li><li>Well suited for distributed and replicated workloads</li></ul></li><li>Spread<ul><li>Each instance is placed on a different rack</li><li>Critical instances should be keep seperated from each other</li><li>Up to 7 instances</li><li>Can be multi AZ</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="user-data"></a>User data<a class="hash-link" href="#user-data" title="Direct link to heading">#</a></h2><ul><li><p>A script that run when lauching an instance (only first launch, restarting will not trigger the execution by default)</p><ul><li>Can be configured to be executed on restart: <a href="https://aws.amazon.com/premiumsupport/knowledge-center/execute-user-data-ec2/" target="_blank" rel="noopener noreferrer">link</a> (the example use mime-multi part file)</li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly txt"><div tabindex="0" class="prism-code language-txt codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: multipart/mixed; boundary=&quot;//&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MIME-Version: 1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--//</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: text/cloud-config; charset=&quot;us-ascii&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MIME-Version: 1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Transfer-Encoding: 7bit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Disposition: attachment; filename=&quot;cloud-config.txt&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#cloud-config</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">cloud_final_modules:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">- [scripts-user, always]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--//</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: text/x-shellscript; charset=&quot;us-ascii&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MIME-Version: 1.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Transfer-Encoding: 7bit</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Disposition: attachment; filename=&quot;userdata.txt&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#!/bin/bash</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">/bin/echo &quot;Hello World&quot; &gt;&gt; /tmp/testfile.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">--//</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div></li><li><p>User data is executed as <code>root</code> by default</p></li><li><p>Debug (on Amazon AMI Linux 2)</p></li></ul><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">tail</span><span class="token plain"> -f /var/log/cloud-init-output.log</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jun 10 09:38:21 cloud-init[3233]: util.py[WARNING]: Failed running /var/lib/cloud/instance/scripts/part-001 [1]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jun 10 09:38:21 cloud-init[3233]: cc_scripts_user.py[WARNING]: Failed to run module scripts-user (scripts in /var/lib/cloud/instance/scripts)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Jun 10 09:38:21 cloud-init[3233]: util.py[WARNING]: Running module scripts-user (&lt;module &#x27;cloudinit.config.cc_scripts_user&#x27; from &#x27;/usr/lib/python2.7/site-packages/cloudinit/config/cc_scripts_user.pyc&#x27;&gt;) failed</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly log"><div tabindex="0" class="prism-code language-log codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Cloud-init v. 19.3-43.amzn2 finished at Thu, 10 Jun 2021 09:43:39 +0000. Datasource DataSourceEc2.  Up 11.33 seconds</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="metadata"></a>Metadata<a class="hash-link" href="#metadata" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><div tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> http://169.254.169.254/latest/meta-data</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="purchase-options"></a>Purchase options<a class="hash-link" href="#purchase-options" title="Direct link to heading">#</a></h2><ul><li><p>Standard (On-Demand)</p><ul><li>Short workload</li></ul></li><li><p>Reserved:</p><ul><li>Reserved Instances: Long workload (1 year or 3 years)</li><li>Convertible Reserved Instances: Long workload with flexible instances (instance type is changable)</li><li>Scheduled Reserved Instances: scheduled</li></ul></li><li><p>Spot instances</p><ul><li>Short workload</li><li>Can lose instances (less reliable)</li></ul></li><li><p>Dedicated Hosts:</p><ul><li>Book entire server/placement. Full control</li></ul></li><li><p>Dedicated Instances:</p></li><li><p>EBS Volume is a network drive (attach through network, not physical drive) which can be attached to instances while they run</p><ul><li>Has latency</li><li>Can be detached and attached to another instance</li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="elastic-block-store-ebs"></a>Elastic Block Store (EBS)<a class="hash-link" href="#elastic-block-store-ebs" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ebs"></a>EBS<a class="hash-link" href="#ebs" title="Direct link to heading">#</a></h3><ul><li>Allow data persistence (after instance termination)</li><li>EBS are bound to availability zone</li><li>Capacity: size in GBs, IOPS (I/O per second)</li><li>When launch an instance, root volume is deleted on termination by default (can be unchecked), other volumes are not</li><li>Has limited performance</li><li>Pay for provision</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="snapshot"></a>Snapshot<a class="hash-link" href="#snapshot" title="Direct link to heading">#</a></h4><ul><li>A backup of EBS at a point of time</li><li>Recommend to detach EBS before snapshot (not necessary)</li><li>Can be copied across AZ and region</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ami"></a>AMI<a class="hash-link" href="#ami" title="Direct link to heading">#</a></h4><ul><li>Amazon Machine Images</li><li>Pre-package softwares for faster boot, monitoring, ...</li></ul><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="types"></a>Types<a class="hash-link" href="#types" title="Direct link to heading">#</a></h4><ul><li>gp2/gp3 (SSD): General Purpose<ul><li>Cost effective, low latency</li><li>1GB - 1TB</li><li>Limited performance:<ul><li>Small gp2 can burst to 3000 IOPS</li><li>Size and IOPS are linked, max is 16000 IOPS</li></ul></li><li>gp3: Newer generation, IOPS and throughput can be increased independently</li></ul></li><li>io1/io2 (SSD): Low-latency, high-throughput workloads<ul><li>io2:<ul><li>Recommended. Same price as io1 but higher durability and IOPS</li><li>Sub-milisecond latency</li></ul></li><li>Support EBS multi-attach</li></ul></li><li>st1 (HDD): Throughput optimized. Frequently accessed</li><li>sc1 (HHD): Cold HDD. Less frequently accessed</li></ul><p>Only SSD-type EBS can be used as boot volume</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ec2-instance-store"></a>EC2 Instance Store<a class="hash-link" href="#ec2-instance-store" title="Direct link to heading">#</a></h3><ul><li>High performance hardware disk</li><li>Connect directly to the server (physical connection)</li><li>Lose the storage when stop (ephemeral storage). Risk of data lost when hardware fails</li><li>Usecase: Buffer, cache, temporary content, ...</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="multi-attach"></a>Multi-attach<a class="hash-link" href="#multi-attach" title="Direct link to heading">#</a></h3><ul><li>Attach the same EBS volume to multiple EC2 instances in the same AZ</li><li>Only works on io1/io2 family volume</li><li>Each instance has full read/write permission on the volume</li><li>Filesystem must be cluster-aware (not XFS, EX4, ...)</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="elastic-file-system-efs"></a>Elastic File System (EFS)<a class="hash-link" href="#elastic-file-system-efs" title="Direct link to heading">#</a></h2><ul><li>Network file system that can be mounted on many EC2 instances</li></ul><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Compatible with Linux based AMI only</p></div></div><ul><li>Works on multi AZ</li><li>Grow to petabyte-scale automatically</li><li>Expensive (3x gp2). Pay for actual usage</li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>EFS-IA (Infrequently Accessed) for cost savings</p></div></div><ul><li>NFSv4.1 protocol</li><li>Use security group to control access to EFS</li><li>Encryption at reset using KMS</li><li>Performance:<ul><li>General Purpose: Latency-sensitive</li><li>Max I/O: higher latency, throughput, highly parallel</li><li>Bursting mode</li></ul></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/moonlight8978/moonlight8978.github.io/edit/v2/books/books/aws-developer-associated/ec2.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-06-18T08:13:43.000Z" class="lastUpdatedDate_1WI_">6/18/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/books/aws-developer-associated/dynamo-db"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« DynamoDB</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/books/aws-developer-associated/ecs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Elastic Container Service Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#instance-types" class="table-of-contents__link">Instance types</a></li><li><a href="#instance-profile" class="table-of-contents__link">Instance Profile</a></li><li><a href="#placement-groups" class="table-of-contents__link">Placement groups</a></li><li><a href="#user-data" class="table-of-contents__link">User data</a></li><li><a href="#metadata" class="table-of-contents__link">Metadata</a></li><li><a href="#purchase-options" class="table-of-contents__link">Purchase options</a></li><li><a href="#elastic-block-store-ebs" class="table-of-contents__link">Elastic Block Store (EBS)</a><ul><li><a href="#ebs" class="table-of-contents__link">EBS</a></li><li><a href="#ec2-instance-store" class="table-of-contents__link">EC2 Instance Store</a></li><li><a href="#multi-attach" class="table-of-contents__link">Multi-attach</a></li></ul></li><li><a href="#elastic-file-system-efs" class="table-of-contents__link">Elastic File System (EFS)</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Self notes</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/moonlight8978/moonlight8978.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://stackoverflow.com/users/8068639/moonlight8978" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 moonlight8978. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9bf10215.js"></script>
<script src="/assets/js/main.a4c2403e.js"></script>
</body>
</html>